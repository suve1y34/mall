<!DOCTYPE HTML>
<!--
	Editorial by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorator="layout/default">
<script th:inline="javascript">
	var productListObj = {

		getProductList  : function(obj) {
			var catCd = [[${param.c_code}]][0],
					page = obj ? $(obj).data("page") : 1;

			$.ajax({
				type : "GET",
				url  : "/productList/" + page + "/ct/" + c_code,
				contentType : "application/json",
				success : function(data) {
					console.log(data);

					var productList      = data.productList.content,
							productPagingDto = data.productPagingDto,
							$productList     = $(".products .product-list"),
							$productListPagination = $(".product-list-pagination");

					// 상품 리스트, 페이지 비우기
					$productList.empty();
					$productListPagination.empty();

					// 상품 리스트 그리기
					if (productList.length > 0) {
						productList.forEach(function(element) {
							var productDiv =
									"<div class='col-sm-6 col-md-4 col-lg-4 mb-30'>" +
									"<div class='product pb-0'>" +
									"<span class='tag-sale'>Sale!</span>" +
									"<div class='product-thumb'>" +
									"<img alt='' src='" + element.title_img + "' class='img-responsive img-fullwidth'>" +
									"<div class='overlay'>" +
									"<div class='btn-add-to-cart-wrapper'>" +
									"<a class='btn btn-theme-colored btn-sm btn-flat pl-20 pr-20 btn-add-to-cart text-uppercase font-weight-700' href='#'>Add To Cart</a>" +
									"</div>" +
									"<div class='btn-product-view-details'>" +
									"<a class='btn btn-default btn-theme-colored btn-sm btn-flat pl-20 pr-20 btn-add-to-cart text-uppercase font-weight-700' href='/productDetails?productId=" + element.id + "'>Product detail</a>" +
									"</div>" +
									"</div>" +
									"</div>" +
									"<div class='product-details text-center bg-lighter pt-15 pb-10'>" +
									"<a href='/productDetails?productId=" + element.id + "'><h5 class='product-title mt-0'>" + element.p_nm + "</h5></a>" +
									"<div class='star-rating' title='Rated 3.50 out of 5'><span style='width: 67%;'>3.50</span></div>" +
									"<div class='price'><del><span class='amount'>$110.00</span></del><ins><span class='amount'><strong> " + element.price + "원</strong></span></ins></div>" +
									"</div>" +
									"</div>" +
									"</div>"

							$(".products .product-list").append(productDiv);
						})
					}

					// 페이징 그리기
					// Prev 페이지
					if (productPagingDto.scaleStartPage !== 1) {
						var prevLi =
								"<li><a data-page='" + productPagingDTO.prePage + "' class='product-list-page' href='#' onclick='productListObj.getProductList(this)' aria-label='Previous'><span aria-hidden='true'>&laquo;</span></a></li>";

						$productListPagination.append(prevLi);
					}

					// 중간 페이지
					for (var i = productPagingDto.scaleStartPage; i <= productPagingDto.scaleEndPage; i++) {
						var pageLi = "";

						if (productPagingDto.page === i) {
							pageLi = "<li class='active'><a data-page='" + i + "' class='product-list-page' href='#' onclick='productListObj.getProductList(this)'>" + i + "</a></li>";
						} else {
							pageLi = "<li class=''><a data-page='" + i + "' class='product-list-page' href='#' onclick='productListObj.getProductList(this)'>" + i + "</a></li>";
						}

						$productListPagination.append(pageLi);
					}

					// Next 페이지
					if (productPagingDto.scaleEndPage !== productPagingDto.totPage) {
						var nextLi =
								"<li><a data-page='" + productPagingDto.nextPage + "' class='product-list-page' href='#' onclick='productListObj.getProductList(this)' aria-label='Next'><span aria-hidden='true'>&raquo;</span></a></li>"

						$productListPagination.append(nextLi);
					}
				},
				error   : function(e) {

				}
			})
		}
	}

	$(function() {

		// 상품 리스트 얻기
		productListObj.getProductList();
	})
</script>

<th:layout layout:fragment="main">
	<!-- Section -->
	<section>
		<header class="main">
			<div class="row-gtr-200">
				<div class="col-6 col-12-medium">
					<ul class="actions">
						<a th:href="@{/admin/pd-regmod}" class="button primary">pd reg</a>
					</ul>
				</div>
			</div>
		</header>
		<div class="box alt">
			<div class="row gtr-50 gtr-uniform products">
				<div class="product-list">
					<th:block th:if="${#lists.size(productList)} > 0" th:each="productList : ${productList.content}">
						<div class="col-sm-6 col-md-4 col-lg-4">
							<div class="pb-0">
								<div class="thumb">
									<img alt="상품이미지" th:src="${productList.getTitle_img()}" class="img-thumbnail"/>
									<div class="overlay">
										<div class="btn">
											<a class="btn" th:href="@{/product/detail(id=%{productList.getId()})}">상세보기</a>
										</div>
									</div>
								</div>
								<div class="text-center bg-light pt-1 pb-1">
									<a th:href="@{/product/detail(id=${productList.getId()})}"><h5 class="title mt-0" th:text="${productList.getP_nm()}"></h5></a>
									<div class="fa-star-half" title="Rated 3.50 out of 5"><span style="width: 67%;">3.50</span></div>
									<div class=""><span class="fa-sort-amount-down" th:text="|${productList.getPrice()}원|"></span></div>
								</div>
							</div>
						</div>
					</th:block>
					<div class="col-md-12">
						<nav>
							<th:block th:if="${pagingDTO.getTotPage() != 0}">
								<ul class="pagination theme-colored mt-0">
									<li th:if="${pagingDTO.getScaleStartPage() != 1}"> <a th:href="@{/productList(page=${pagingDTO.getPrevPage()}, c_code=${c_code})}" aria-label="Previous"> <span aria-hidden="true">&laquo;</span> </a> </li>
									<li th:each="i : ${#numbers.sequence(pagingDTO.getScaleStartPage(),pagingDTO.getScaleEndPage())}" th:class="${pagingDTO.page eq i} ? active : ''">
										<a th:href="@{/productList(page=${i}, catCd=${catCd})}" th:text="${i}"></a>
									</li>
									<li th:if="${pagingDTO.getScaleEndPage() != pagingDTO.getTotPage()}"> <a th:href="@{/productList(page=${pagingDTO.getNextPage()}, c_code=${c_code})}" aria-label="Next"> <span aria-hidden="true">&raquo;</span> </a> </li>
								</ul>
							</th:block>
						</nav>
					</div>
				</div>
			</div>

<!--			<th:block layout:fragment="paging">
				<nav th:replace="fragments/paging :: pagination"></nav>
			</th:block>-->
		</div>
	</section>
</th:layout>
</html>
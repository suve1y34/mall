<!DOCTYPE HTML>
<!--
	Editorial by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorator="layout/default">
<th:layout layout:fragment="main">
	<script>
		function requestPay() {
			// IMP.request_pay(param, callback) 호출
			IMP.request_pay({ // param
				pg: "kakaopay",
				pay_method: "card",
				merchant_uid: "merchant_" + new Date().getTime(),
				name: "노르웨이 회전 의자",
				amount: 64900,
				buyer_email: "gildong@gmail.com",
				buyer_name: "홍길동",
				buyer_tel: "010-4242-4242",
				buyer_addr: "서울특별시 강남구 신사동",
				buyer_postcode: "01181"
			}, function (rsp) { // callback
				if (rsp.success) { // 결제 성공 시: 결제 승인 또는 가상계좌 발급에 성공한 경우
					// jQuery로 HTTP 요청
					//[1] 서버단에서 결제정보 조회를 위해 jQuery ajax로 imp_uid 전달하기
					jQuery.ajax({
						url: "https://www.myservice.com/payments/complete", // 가맹점 서버
						method: "POST",
						headers: { "Content-Type": "application/json" },
						data: {
							imp_uid: rsp.imp_uid,
							merchant_uid: rsp.merchant_uid
							//기타 필요한 데이터가 있으면 추가 전달
						}
					}).done(function (data) {
						//[2] 서버에서 REST API로 결제정보확인 및 서비스루틴이 정상적인 경우
						// 가맹점 서버 결제 API 성공시 로직
						if(everythings_fine) {
							msg = '결제가 완료되었습니다.';
							msg += '\n고유ID: ' + rsp.imp_uid;
							msg += '\n상점 거래ID: ' + rsp.merchant_uid;
							msg += '\n결제 금액: ' + rsp.paid_amount;
							msg += '카드 승인번호: ' + rsp.apply_num;
						} else {
							//[3] 아직 제대로 결제가 되지 않았습니다.
							//[4] 결제된 금액이 요청한 금액과 달라 결제를 자동취소처리하였습니다.
						}
					})
					//성공시 이동할 페이지
					location.href = 'msg='+msg;
				} else {
					alert("결제에 실패하였습니다. 에러 내용: " +  rsp.error_msg);
					//실패시 이동할 페이지
					location.href = "";
					alert(msg);
				}
			});
		}
	</script>
	<!-- Section -->
	<section>
		<header class="main">
			<h2>ORDER</h2>
		</header>
		<form action="" method="post">
			<div class="table-wrapper">
				<h4>주문상품</h4>
				<table>
					<tbody>
					<tr>
						<td>
							<span class="image left">
								<img src="images/pic01.jpg" alt="">
							</span>
							웅앵커피<br>
						</td>
						<td>X 1</td>
						<td>12,000</td>
					</tr>
					</tbody>
				</table>
			</div>
			<h4>배송정보</h4>
			<div class="table-wrapper">
				<table>
					<tr>
						<td class="col-6 col-12-xsmall">
							<label for="rec">받는 분</label>
							<input type="text" name="rec" id="rec">
						</td>
						<td>
							<input type="text" value="" placeholder="이름">
						</td>
					</tr>
					<tr>
						<td class="col-6 col-12-xsmall">
							<label for="phone">휴대전화</label>
							<input type="text" name="phone" id="phone">
						</td>
						<td>
						<input type="text" value="" placeholder="휴대전화">
						</td>
					</tr>

<!--					<tr>
						<td class="col-2 col-12-xsmall">
							<label for="email">이메일</label>
						</td>
						<td>
							<input type="email" value="" placeholder="이메일">
						</td>
					</tr>-->
					<tr>
						<td class="col-2 col-12-xsmall">
							<label for="postCode">주소</label>
							<input type="text" name="postCode" id="postCode" placeholder="우편번호">
							<input type="button" onclick="execDaumPostcode()" value="우편번호 찾기"><br>
							<input type="text" name="address" id="address" placeholder="주소">
							<input type="text" name="de_address" id="de_address" placeholder="상세주소">
							<input type="text" id="extraAddress" class="d_form" placeholder="참고항목">
							<div id="wrap" style="display: none; border: 1px solid; width: 500px; height: 466px; margin: 5px 0px; position: relative;">
								<img src="//t1.daumcdn.net/postcode/resource/images/close.png" id="btnFoldWrap" style="cursor: pointer; position: absolute; right: 0px; top:-1px; z-index:1" onclick="foldDaumPostcode()" alt="접기 버튼">
							</div>
						</td>
					</tr>
					<!--					<tr>
                						<td class="col-2 col-12-xsmall">
                                                <label for="">배송 메시지</label>
                                                <textarea id="demo-message" placeholder="배송기사님께 전달할 메시지입니다" rows="2"></textarea>
                                            </td>
                                        </tr>-->
				</table>
			</div>
			<div class="table-wrapper">
				<table>
					<thead>
					<tr>
						<th>결제</th>
					</tr>
					</thead>
					<tbody>
					<tr>
						<td>
							<input type="radio"><label>신용카드</label>
							<input type="radio"><label>계좌이체</label>
							<input type="radio"><label>휴대폰</label>
							<input type="radio"><label>무통장입금</label>
						</td>
					</tr>
					</tbody>
				</table>
			</div>
			<div class="table-wrapper">
				<table>
					<tr>
						<td class="">상품금액</td><td class="">12,000 원</td>
					</tr>
					<tr>
						<td class="">배송비</td><td class="">2,500 원</td>
					</tr>
					<tr>
						<td class="">결제예정</td><td class="">14,500 원</td>
					</tr>
				</table>
			</div>
			<button type="submit" class="orderBtn primary">주문</button>
			<button type="button" class="button cancelBtn"></button>
		</form>
	</section>
</th:layout>
</html>